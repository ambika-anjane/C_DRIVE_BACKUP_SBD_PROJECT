
SELECT DISTINCT * FROM
( SELECT RETAILERID,
         RETAILERSKU,
         WEEKID
  FROM "PROD_RAW"."STACKLINE".SALES
  WHERE WEEKID >= 202201
  UNION ALL
  SELECT RETAILERID,
         RETAILERSKU,
         WEEKID
  FROM "PROD_RAW"."STACKLINE".RATINGSREVIEWS
  WHERE WEEKID >= 202201
  UNION ALL
  SELECT RETAILERID,
         RETAILERSKU,
         WEEKID
  FROM "PROD_RAW"."STACKLINE".PROMOTIONS
  WHERE WEEKID >= 202201
  UNION ALL
  SELECT RETAILERID,
         RETAILERSKU,
         WEEKID
  FROM "PROD_RAW"."STACKLINE".CONTENTSCORE
  WHERE WEEKID >= 202201),
  SELECT R.RETAILERID,
         COALESCE(S.RETAILERNAME, RV.RETAILERNAME, CS.RETAILERNAME, P.RETAILERNAME) AS RETAILERNAME,
         R.RETAILERSKU,
         COALESCE(S.UPC, RV.UPC, CS.UPC, P.UPC) AS UPC,
         COALESCE(S.MODELNUMBER, RV.MODELNUMBER, CS.MODELNUMBER, P.MODELNUMBER) AS MODELNUMBER,
         COALESCE(S.TITLE, RV.TITLE, CS.TITLE, P.TITLE) AS TITLE,
         COALESCE(S.BRAND, RV.BRAND, CS.BRAND, P.BRAND) AS BRAND,
         COALESCE(S.CATEGORY, RV.CATEGORY, CS.CATEGORY, P.CATEGORY) AS CATEGORY,
         COALESCE(S.SUBCATEGORY, RV.SUBCATEGORY, CS.SUBCATEGORY, P.SUBCATEGORY) AS SUBCATEGORY,
         R.WEEKID,
         COALESCE(S.WEEKENDING, RV.WEEKENDING, CS.WEEKENDING, P.WEEKENDING) AS WEEKENDING,
         P.PROMOTYPE AS PROMOTYPE,
         P.DEALDATE AS DEALDATE,
         COALESCE(S.RETAILPRICE, P.RETAILPRICE) AS RETAILPRICE,
         P.RETAILPRICECHANGE AS RETAILPRICECHANGE,
         P.RETAILSALESCHANGE AS RETAILSALESCHANGE,
         COALESCE(S.UNITSSOLD, P.UNITSSOLD) AS UNITSSOLD,
         P.UNITSSOLDCHANGE AS UNITSSOLDCHANGE,
         COALESCE(S.RETAILSALES, RV.RETAILSALES, CS.RETAILSALES, P.RETAILSALES) AS RETAILSALES,
         RV.RATING AS RATING,
         RV.REVIEWSCOUNT AS REVIEWSCOUNT
  FROM DEV_EDW.PUBLIC.STACKLINE_RETAILERS R 
         LEFT OUTER JOIN "PROD_RAW"."STACKLINE".SALES S
              ON R.RETAILERID = S.RETAILERID
             AND R.RETAILERSKU = S.RETAILERSKU
             AND R.WEEKID = S.WEEKID
         LEFT OUTER JOIN "PROD_RAW"."STACKLINE".RATINGSREVIEWS RV
              ON R.RETAILERID = RV.RETAILERID
             AND R.RETAILERSKU = RV.RETAILERSKU
             AND R.WEEKID = RV.WEEKID
         LEFT OUTER JOIN "PROD_RAW"."STACKLINE".CONTENTSCORE CS
              ON R.RETAILERID = CS.RETAILERID
             AND R.RETAILERSKU = CS.RETAILERSKU
             AND R.WEEKID = CS.WEEKID
         LEFT OUTER JOIN "PROD_RAW"."STACKLINE".PROMOTIONS P
              ON R.RETAILERID = P.RETAILERID
             AND R.RETAILERSKU = P.RETAILERSKU
             AND R.WEEKID = P.WEEKID
